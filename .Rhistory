),
alpha = 0.20
) +
scale_size(
breaks = c(0.2,1,5, 25)*3,
labels = c(0.2,1,5, 25),
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
dev.off()
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency*10,
position = position_jitter(height= 0.15, width = 0.15)
),
alpha = 0.20
) +
scale_size(
breaks = c(0.2,1,5, 25)*3,
labels = c(0.2,1,5, 25),
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency*10
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
scale_size(
breaks = c(0.2,1,5, 25)*3,
labels = c(0.2,1,5, 25),
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
# scale_size(
#   breaks = c(0.2,1,5, 25)*3,
#   labels = c(0.2,1,5, 25),
#   guide = "legend"
# )+
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency*10
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
# scale_size(
#   breaks = c(0.2,1,5, 25)*3,
#   labels = c(0.2,1,5, 25),
#   guide = "legend"
# )+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency*10
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
scale_size(
breaks = c(0.2,1,5, 25)*3,
labels = c(0.2,1,5, 25)/10,
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency*10
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
scale_size(
breaks = c(0.2,1,5, 25),
labels = c(0.2,1,5, 25)/10,
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency*10
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
scale_size(
breaks = fire_frequency/10,
labels = fire_frequency/10,
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency*10
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
scale_size(
breaks = range(fire_frequency)/10,
labels = fire_frequency/10,
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency*10
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
scale_size(
breaks = (10,30, 60),
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency*10
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
scale_size(
breaks = c(10,30, 60),
labels = c(10,30, 60)/10,
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
comm_data
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
scale_size(
breaks = c(10,30, 60),
labels = c(10,30, 60)/10,
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
scale_size(
breaks = c(1,3, 6),
labels = c(1,3, 6),
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
### export fire map
tiff("plots/fire_map.tiff", units="cm", width=7, height=7, res=600)
ggplot(data = comm_data) +
geom_point(aes(x = longitude,
y = latitude,
size = fire_frequency
),
alpha = 0.20,
position = position_jitter(height= 0.15, width = 0.15)
) +
scale_size(
breaks = c(1,3, 6),
labels = c(1,3, 6),
guide = "legend"
)+
xlab("Longitude") +
ylab("Latitude") +
theme(panel.background=element_rect(fill="white"),
panel.grid=element_line(colour=NULL),
panel.border=element_rect(fill=NA,colour="black"),
axis.title.x = element_text(size=12, face="bold"),
axis.title.y = element_text(size=12, face="bold"),
axis.text.x = element_text(size= 10, angle = 0),
axis.text.y = element_text(size= 10, angle = 0),
legend.title= element_blank(),
legend.key.size =  unit(0.05, 'cm'),
legend.background = element_rect(colour = "black", linetype='solid', fill = NA),
legend.key = element_rect(colour = NA, fill = NA),
legend.direction="vertical",
legend.position = c(0.8,0.70)
)
dev.off()
ggplot(data = comm_data  ) +
geom_point(aes(
x = burned,
y = fisher
)
)
ggplot(data = comm_data  ) +
geom_point(aes(
x = burned,
y = floristic_PCo1
)
)
ggplot(data = comm_data  ) +
geom_point(aes(
x = burned,
y = floristic_PCo2
)
)
ggplot(data = comm_data  ) +
geom_point(aes(
x = burned,
y = floristic_PCo1
)
)
model_fit = glm(
data = s_comm_data,
richness ~ (burned + seasonal_precipitation + soil_PC1+ soil_PC2),
family = poisson(link = "identity") # log, identity, and sqrt
)
summary(model_fit)
### environmental data
comm_data = read.csv("0_data/comm_data.csv", sep=",", h=T)
head(comm_data)
### species data
ind_data = read.csv("0_data/ind_data.csv", sep=",", h=T, stringsAsFactors = T)
head(ind_data)
### processing individual data
ind_data  =  ind_data %>%
filter(!is.na(sp)) %>%
unite("plot_id", site, plot, sep="_", remove = FALSE)
### processing community data
comm_data  =  comm_data %>%
unite("plot_id", site, plot, sep="_", remove = FALSE)
### transforming fire
comm_data = comm_data %>%
mutate(fire_frequency = burned
) %>%
mutate(trans_fire = log(fire_frequency)
)
### transforming fire
comm_data = comm_data %>%
mutate(fire_frequency = burned)
### scaled predictors
s_comm_data = comm_data %>%
mutate(
fire_frequency = scale(fire_frequency),
seasonal_precipitation = scale(seasonal_precipitation),
soil_PC1 = scale(soil_PC1),
soil_PC2 = scale(soil_PC2)
)
hist(comm_data$fire_frequency)
hist(comm_data$trans_fire)
### transforming fire
comm_data = comm_data %>%
mutate(fire_frequency = burned*10)
### scaled predictors
s_comm_data = comm_data %>%
mutate(
fire_frequency = scale(fire_frequency),
seasonal_precipitation = scale(seasonal_precipitation),
soil_PC1 = scale(soil_PC1),
soil_PC2 = scale(soil_PC2)
)
hist(comm_data$fire_frequency)
### all explanatory vars
all_explanatory = c("fire_frequency",
"seasonal_precipitation",
"soil_PC1",
"soil_PC2"
)
### all x-axis labels
all_xlabels = c("Fire frequency",
"Seasonal precipitation",
"Soil PC1",
"Soil PC2"
)
### check residual
check_resid = function(model){
N = model$dims$N
resid_n = resid(model)[1:N]
shapiro.test(resid_n)
}
### sp presence matrix
plot_mtx = ind_data %>%
group_by(plot_id, sp) %>%
reframe(n = n()) %>%
mutate(n = case_when(n >1 ~ 1, T ~ n)) %>%
pivot_wider(
names_from =  sp,
names_expand = T,
values_from = n,
values_fill = 0
)
### dissimilarity
distance = vegdist(plot_mtx[,-1], method = "bray")
exdistance = stepacross(dis = distance, path = "extended")
### pcoa
ord = pcoa(exdistance)
##
ord$values
sum(ord$values$Relative_eig)
### gls model
glm_fire1 = gls(
data = s_comm_data,
fire_frequeny ~ seasonal_precipitation + soil_PC1 + soil_PC2,
family = poisson(link = "identity")
)
### gls model
glm_fire1 = glm(
data = s_comm_data,
fire_frequeny ~ seasonal_precipitation + soil_PC1 + soil_PC2,
family = poisson(link = "identity")
)
### gls model
glm_fire1 = glm(
data = s_comm_data,
fire_frequency ~ seasonal_precipitation + soil_PC1 + soil_PC2,
family = poisson(link = "identity")
)
### scaled predictors
s_comm_data = comm_data %>%
mutate(
s_fire_frequency = scale(fire_frequency),
seasonal_precipitation = scale(seasonal_precipitation),
soil_PC1 = scale(soil_PC1),
soil_PC2 = scale(soil_PC2)
)
s_comm_data
### gls model
glm_fire1 = glm(
data = s_comm_data,
fire_frequency ~ seasonal_precipitation + soil_PC1 + soil_PC2,
family = poisson(link = "identity")
)
summary(glm_fire1)
plot(gls_fire1)
check_resid(model = glm_fire1)
glm_fire1
shapiro.test( residuals(glm_fire1) )
